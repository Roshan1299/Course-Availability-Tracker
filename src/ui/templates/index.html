<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Course Availability Tracker</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <header>
    <h1>ğŸ“ Course Availability Tracker</h1>
    <p>Never miss an open seat again</p>
  </header>

  <div class="onboarding">
    <h3>ğŸš€ How to Get Started</h3>
    <ol>
      <li>
        <strong>Visit <a href="https://register.beartracks.ualberta.ca/criteria.jsp" target="_blank" rel="noopener noreferrer">BearTracks Schedule Builder</a></strong>
        <br />Build your schedule and add the courses you want to monitor
      </li>
      <li>
        <strong>Copy the page URL</strong>
        <br />Once your courses are listed, copy the full URL from your browser
      </li>
      <li>
        <strong>Paste below and start monitoring</strong>
        <br />We'll watch seat availability in the background
      </li>
    </ol>
  </div>

  <section class="card">
    <h2>Set Up Monitoring</h2>

    <form id="monitor-form">
      <input required placeholder="Paste your BearTracks URL here" id="url" class="full-width" />
      <div class="form-row">
        <input required placeholder="Course Code (e.g. CMPUT 402)" id="course_code" class="small-field" />
        <input required placeholder="Section (e.g. LEC B1, LAB D1)" id="section_label" class="small-field" />
        <input type="number" min="30" value="90" id="interval" placeholder="Interval (sec)" class="small-field" />
      </div>

      <label>
        <input type="checkbox" id="notify" checked />
        Send email notifications when seats become available
      </label>

      <button type="submit">Start Monitoring</button>
    </form>
  </section>

  <div class="info-section">
    <h3>ğŸ§  Understanding Monitor Status</h3>
    <div class="status-grid">
      <div class="status-item">
        <h4>Mode (What you want)</h4>
        <p>â–¶ <strong>Active:</strong> Monitoring is running</p>
        <p>â¸ <strong>Paused:</strong> Temporarily stopped</p>
      </div>
      <div class="status-item">
        <h4>Health (What's happening)</h4>
        <p>ğŸŸ¢ <strong>Healthy:</strong> Page loaded, data fetched successfully</p>
        <p>ğŸŸ¡ <strong>Stale:</strong> Course/section not found on page</p>
        <p>ğŸ”´ <strong>Error:</strong> Issue checking page</p>
      </div>
    </div>
  </div>

  <section class="card">
    <h2>Active Monitors</h2>
    <table>
      <thead>
        <tr>
          <th>Course</th>
          <th>Section</th>
          <th>Last Seen</th>
          <th>Last Checked</th>
          <th>Last Changed</th>
          <th>Mode</th>
          <th>Health</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="monitors">
        <tr class="empty">
          <td colspan="8">No monitors running yet</td>
        </tr>
      </tbody>
    </table>
  </section>

  <div class="info-section">
    <h3>ğŸ“œ Notification History</h3>
    <p>Every seat change notification is saved in your history. Click <strong>View History</strong> on any monitor to see past notifications for that course.</p>
  </div>

  <div class="info-section">
    <h3>ğŸ’¡ Tips</h3>
    <ul>
      <li>Use longer check intervals (60â€“120 seconds) to reduce load</li>
      <li>You can monitor multiple courses simultaneously</li>
      <li>Paused monitors keep their history and can be resumed instantly</li>
    </ul>
  </div>

  <!-- Modal for notification history -->
  <div id="history-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Notification History</h3>
        <span class="close">&times;</span>
      </div>
      <div class="modal-body">
        <table id="history-table">
          <thead>
            <tr>
              <th>From</th>
              <th>To</th>
              <th>Time</th>
            </tr>
          </thead>
          <tbody id="history-body"></tbody>
        </table>
      </div>
    </div>
  </div>

  <script src="/static/app.js"></script>
</body>
</html>
